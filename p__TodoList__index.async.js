"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[130],{75457:function(_o,lo,l){l.r(lo),l.d(lo,{default:function(){return Xo}});var yo=l(42122),d=l.n(yo),ho=l(861),uo=l.n(ho),Co=l(27424),P=l.n(Co),M=l(55375),F=function(c){return c.TODO_LIST_ATOM="TODO_LIST_ATOM",c.NOT_DONE_TODO_LIST_ATOM_SELECTOR="NOT_DONE_TODO_LIST_ATOM_SELECTOR",c.DONE_TODO_LIST_ATOM_SELECTOR="DONE_TODO_LIST_ATOM_SELECTOR",c.CUR_TODO_LIST_ATOM_SELECTOR="CUR_TODO_LIST_ATOM_SELECTOR",c.CUR_ACTIVE_CATEGORY_DETAIL_SELECTOR="CUR_ACTIVE_CATEGORY_DETAIL_SELECTOR",c}({}),V=l(59731),Lo=l(38416),Q=l.n(Lo),B,m=function(c){return c.ALL="ALL",c.DONE="DONE",c.NOT_DONE="NOT_DONE",c}({}),H=(B={},Q()(B,m.ALL,"\u6240\u6709"),Q()(B,m.DONE,"\u5DF2\u5B8C\u6210"),Q()(B,m.NOT_DONE,"\u5F85\u529E"),B),y=l(96486),mo=function(n,u,t){if((0,y.isArray)(n)){var v=(0,y.cloneDeep)(n),a=(0,y.pullAt)(v,u),e=P()(a,1),g=e[0];return v.splice(t,0,g),v}return n},h=l(22638),Oo=l(69483),k=l.n(Oo),D=l(67294),S=l(4480),G=(0,S.cn)({key:F.TODO_LIST_ATOM,default:{isLoading:!1,todoList:[],categoryInfo:{curCategoryId:"",categoryList:[{id:"",title:M.sN}]},groupType:m.NOT_DONE}}),po=(0,S.nZ)({key:F.DONE_TODO_LIST_ATOM_SELECTOR,get:function(n){var u=n.get,t=u(G),v=t.todoList,a=t.categoryInfo;return(0,y.filter)(v,function(e){return(e==null?void 0:e.done)&&(a==null?void 0:a.curCategoryId)===((e==null?void 0:e.categoryId)||"")})}}),Io=(0,S.nZ)({key:F.NOT_DONE_TODO_LIST_ATOM_SELECTOR,get:function(n){var u=n.get,t=u(G),v=t.todoList,a=t.categoryInfo;return(0,y.filter)(v,function(e){return!(e!=null&&e.done)&&(a==null?void 0:a.curCategoryId)===((e==null?void 0:e.categoryId)||"")})}}),xo=(0,S.nZ)({key:F.CUR_TODO_LIST_ATOM_SELECTOR,get:function(n){var u=n.get,t=u(G),v=t.todoList,a=t.categoryInfo;return(0,y.filter)(v,function(e){return(a==null?void 0:a.curCategoryId)===((e==null?void 0:e.categoryId)||"")})}}),Do=(0,S.nZ)({key:F.CUR_ACTIVE_CATEGORY_DETAIL_SELECTOR,get:function(n){var u=n.get,t=u(G),v=t.categoryInfo;return(0,y.find)(v==null?void 0:v.categoryList,function(a){return(a==null?void 0:a.id)===(v==null?void 0:v.curCategoryId)})}}),So=function(){var n=(0,S.FV)(G),u=P()(n,2),t=u[0],v=t.isLoading,a=t.todoList,e=t.categoryInfo,g=t.groupType,T=u[1],O=(0,S.sJ)(po),L=(0,S.sJ)(Io),p=(0,S.sJ)(xo),C=(0,D.useMemo)(function(){return function(){switch(g){case m.ALL:return p;case m.DONE:return O;case m.NOT_DONE:return L;default:return[]}}()},[g,p,O,L]),Z=(0,S.sJ)(Do),A=(0,h.Z)(function(s){k().setItem(V.F.TODO_LIST_KEY,s)}),R=(0,h.Z)(function(s){k().setItem(V.F.TODO_CATEGORY_INFO_KEY,s)}),Y=(0,h.Z)(function(s){var o=[].concat(uo()(a),[{id:"".concat(M.Xt).concat(new Date().getTime()),title:"",content:"",seq:"",done:!1,note:"",categoryId:s||""}]);T(function(i){return d()(d()({},i),{},{todoList:o})}),A(o)}),N=(0,h.Z)(function(s){var o=(0,y.filter)(a,function(i){return(i==null?void 0:i.id)!==s});T(function(i){return d()(d()({},i),{},{todoList:o})}),A(o)}),J=(0,h.Z)(function(s){var o=(0,y.filter)(a,function(i){return(i==null?void 0:i.categoryId)!==s});T(function(i){return d()(d()({},i),{},{todoList:o})}),A(o)}),K=(0,h.Z)(function(s){var o=s.id,i=(0,y.map)(a,function(f){return(f==null?void 0:f.id)===o?d()(d()({},f),s):f});T(function(f){return d()(d()({},f),{},{todoList:i})}),A(i)}),oo=(0,h.Z)(function(){var s=d()(d()({},e),{},{categoryList:[].concat(uo()((e==null?void 0:e.categoryList)||[]),[{id:"".concat(M.Yy).concat(new Date().getTime()),title:M.Is}])});T(function(o){return d()(d()({},o),{},{categoryInfo:s})}),R(s)}),to=(0,h.Z)(function(s){if(s){var o,i=(0,y.findIndex)(e==null?void 0:e.categoryList,function(x){return(x==null?void 0:x.id)===s}),f=i===-1?"":(e==null||(o=e.categoryList[i-1])===null||o===void 0?void 0:o.id)||"",I=s!==(e==null?void 0:e.curCategoryId)?e==null?void 0:e.curCategoryId:f,io=(0,y.filter)(e==null?void 0:e.categoryList,function(x){return(x==null?void 0:x.id)!==s}),W=d()(d()({},e),{},{curCategoryId:I,categoryList:io});T(function(x){return d()(d()({},x),{},{categoryInfo:W})}),R(W),J(s)}}),eo=(0,h.Z)(function(s){var o=s.id,i=(0,y.map)(e==null?void 0:e.categoryList,function(I){return(I==null?void 0:I.id)===o?d()(d()({},I),s):I}),f=d()(d()({},e),{},{categoryList:i});T(function(I){return d()(d()({},I),{},{categoryInfo:f})}),R(f)}),no=(0,h.Z)(function(s){var o=d()(d()({},e),{},{curCategoryId:s});T(function(i){return d()(d()({},i),{},{categoryInfo:o})}),R(o)}),ro=(0,h.Z)(function(s){T(function(o){return d()(d()({},o),{},{groupType:s})})});(0,D.useEffect)(function(){T(function(i){return d()(d()({},i),{},{isLoading:!0})});var s=k().getItem(V.F.TODO_CATEGORY_INFO_KEY).then(function(i){i&&T(function(f){return d()(d()({},f),{},{categoryInfo:i})})}),o=k().getItem(V.F.TODO_LIST_KEY).then(function(i){i&&T(function(f){return d()(d()({},f),{},{todoList:i})})});Promise.all([s,o]).finally(function(){T(function(i){return d()(d()({},i),{},{isLoading:!1})})})},[]);var ao=function(o){var i,f,I=o.oldIndex,io=o.newIndex,W=(i=C[I])===null||i===void 0?void 0:i.id,x=(f=C[io])===null||f===void 0?void 0:f.id,$o=(0,y.findIndex)(a,function(j){return(j==null?void 0:j.id)===W}),bo=(0,y.findIndex)(a,function(j){return(j==null?void 0:j.id)===x}),go=mo(a,$o,bo);T(function(j){return d()(d()({},j),{},{todoList:go})}),A(go)};return{isLoading:v,todoList:a,curTodoList:p,doneTodoList:O,notDoneTodoList:L,groupType:g,curDisplayTodoList:C,categoryInfo:e,curActiveCategoryDetail:Z,handleSetGroupType:ro,handleAddTodoItem:Y,handleRemoveTodoItem:N,handleUpdateTodoItem:K,handleSortTodoItemEnd:ao,handleAddCategory:oo,handleRemoveCategory:to,handleUpdateCategory:eo,handleClickCategory:no}},Eo=function(n,u,t){var v=Math.round(t);if(v<0)return Promise.reject("bad duration");var a=n.scrollTop,e=u-a,g=Date.now(),T=function O(){var L=(Date.now()-g)/v;L>1&&(L=1);var p=.5*(1-Math.cos(Math.PI*L)),C=a+e*p;n.scrollTop=C,L<1&&requestAnimationFrame(O)};requestAnimationFrame(T)},Ao=function(n){var u=(0,D.useRef)(null),t=function(){if(u.current!==null){var a,e=u.current.scrollHeight;Eo(u.current,e,(a=n==null?void 0:n.duration)!==null&&a!==void 0?a:500)}};return(0,D.useEffect)(t,[u]),{domRef:u,scrollToBottom:t}},Zo=l(97937),vo=l(24969),jo=l(33904),z=l(21612),so=l(68508),X=l(71230),U=l(15746),Ro=l(5737),$=l(15867),co=l(78045),No=l(48689),Uo=l(55914),Mo=l(77554),b=l(97689),Po=l(56616),_=l(68916),q=l(67759),Fo=l(88942),w={"todo-item-wrapper":"todo-item-wrapper___mQ3WK","check-box":"check-box___BtGdO",title:"title___A7EVV",content:"content___ZJKzG","delete-icon":"delete-icon___RQmjp"},r=l(85893),Bo=b.Z.Title,Go=b.Z.Paragraph,wo=function(n){var u=n.index,t=n.todoListItem,v=n.onUpdateItem,a=n.onRemoveItem,e=(0,D.useState)(!1),g=P()(e,2),T=g[0],O=g[1],L=(0,D.useRef)(null),p=(0,Fo.Z)(),C=P()(p,1),Z=C[0],A=function(){setTimeout(function(){return O(!0)})},R=(0,h.Z)(function(){T&&O(!1)}),Y=(0,y.debounce)(function(N,J){v(d()({id:t==null?void 0:t.id},N))},200);return(0,Uo.Z)(R,L),(0,Mo.Z)(["enter","esc"],function(){T&&O(!1)}),(0,r.jsx)("div",{className:w["todo-item-wrapper"],children:T?(0,r.jsx)("div",{ref:L,children:(0,r.jsxs)(_.Z,{form:Z,initialValues:{title:(t==null?void 0:t.title)||"",content:(t==null?void 0:t.content)||""},onValuesChange:Y,children:[(0,r.jsx)(_.Z.Item,{name:"title",label:"\u6807\u9898",children:(0,r.jsx)(q.Z,{})}),(0,r.jsx)(_.Z.Item,{name:"content",label:"\u5185\u5BB9",children:(0,r.jsx)(q.Z,{})})]})}):(0,r.jsx)(b.Z,{children:(0,r.jsxs)(X.Z,{align:"middle",children:[(0,r.jsx)(U.Z,{style:{flex:"none"},children:(0,r.jsx)("div",{className:w["check-box"],children:(0,r.jsx)(Po.Z,{checked:t==null?void 0:t.done,onChange:function(){return v({id:t==null?void 0:t.id,done:!(t!=null&&t.done)})}})})}),(0,r.jsxs)(U.Z,{style:{flex:"1"},children:[(0,r.jsxs)(Bo,{className:w.title,level:2,onClick:A,children:[(0,r.jsx)("span",{children:"\u{1F516} "}),"".concat(u,": ").concat((t==null?void 0:t.title)||"")]}),(0,r.jsx)(Go,{className:w.content,onClick:A,children:(t==null?void 0:t.content)||"\u586B\u5199 Todo \u5185\u5BB9..."})]}),(0,r.jsx)(U.Z,{style:{flex:"none"},children:(0,r.jsx)(No.Z,{className:w["delete-icon"],onClick:function(){return a(t==null?void 0:t.id)}})})]})})})},Yo=(0,D.memo)(wo),fo=l(92678),Vo=(0,fo.W8)(function(c){var n=c.value,u=c.idx,t=c.onUpdateItem,v=c.onRemoveItem;return(0,r.jsx)(Yo,{index:u+1,todoListItem:n,onUpdateItem:t,onRemoveItem:v},n==null?void 0:n.id)}),ko=(0,fo.JN)(function(c){var n=c.items,u=c.onUpdateItem,t=c.onRemoveItem;return(0,r.jsx)("div",{children:(0,y.map)(n,function(v,a){return(0,r.jsx)(Vo,{index:a,value:v,idx:a,onUpdateItem:u,onRemoveItem:t},"item-".concat(v==null?void 0:v.id))})})}),zo=(0,D.memo)(ko),Jo=l(62666),Ko=function(n){var u=n.curActiveCategoryDetail,t=n.onUpdateCategory,v=(0,D.useState)(!1),a=P()(v,2),e=a[0],g=a[1],T=(0,D.useRef)(),O=(0,h.Z)(function(){g(!0),setTimeout(function(){var C;T==null||(C=T.current)===null||C===void 0||C.focus()})}),L=(0,h.Z)((0,y.throttle)(function(C){var Z;t({id:u==null?void 0:u.id,title:C==null||(Z=C.target)===null||Z===void 0?void 0:Z.value})},200)),p=(0,h.Z)(function(){g(!1)});return e?(0,r.jsx)(q.Z,{ref:T,value:u==null?void 0:u.title,onBlur:p,onPressEnter:p,onChange:L,style:{marginBottom:"12px"}}):(0,r.jsx)(Jo.Z,{level:3,onClick:O,children:(u==null?void 0:u.title)||M.sN})},Wo=Ko,E={"layout-all-wrapper":"layout-all-wrapper___YzEYt","sider-wrapper":"sider-wrapper___WE5eN","side-menu":"side-menu___dM783","menu-item-container":"menu-item-container___ryyZw","menu-item-left-wrapper":"menu-item-left-wrapper___IMyuH","delete-button":"delete-button___gbw7P","layout-right-wrapper":"layout-right-wrapper___yPGhM","content-wrapper":"content-wrapper___hpw17","group-type-radio-group":"group-type-radio-group___rrp0Q","todo-list-content-wrapper":"todo-list-content-wrapper___v73us"},To=z.Z.Content,Qo=z.Z.Sider,Ho=function(){var n=So(),u=n.isLoading,t=n.curTodoList,v=n.doneTodoList,a=n.notDoneTodoList,e=n.curDisplayTodoList,g=n.categoryInfo,T=n.groupType,O=n.curActiveCategoryDetail,L=n.handleAddTodoItem,p=n.handleRemoveTodoItem,C=n.handleUpdateTodoItem,Z=n.handleSortTodoItemEnd,A=n.handleSetGroupType,R=n.handleAddCategory,Y=n.handleRemoveCategory,N=n.handleUpdateCategory,J=n.handleClickCategory,K=Ao(),oo=K.domRef,to=K.scrollToBottom,eo=[{todoType:m.ALL,count:(t==null?void 0:t.length)||0,status:H[m.ALL]},{todoType:m.NOT_DONE,count:(a==null?void 0:a.length)||0,status:H[m.NOT_DONE]},{todoType:m.DONE,count:(v==null?void 0:v.length)||0,status:H[m.DONE]}],no=(0,y.map)(g==null?void 0:g.categoryList,function(o){return{key:o==null?void 0:o.id,label:o==null?void 0:o.title}}),ro=(0,h.Z)(function(o){var i;A(o==null||(i=o.target)===null||i===void 0?void 0:i.value)}),ao=(0,h.Z)(function(o){J(o==null?void 0:o.key)}),s=(0,h.Z)(function(o){L(o),setTimeout(function(){return to()})});return(0,r.jsx)(jo._z,{header:{title:"Todo list",subTitle:"\u522B\u8BA9\u672A\u6765\u7684\u98CE\u9669\u5F71\u54CD\u73B0\u5728\u7684\u4F60"},loading:u,children:(0,r.jsxs)(z.Z,{className:E["layout-all-wrapper"],children:[(0,r.jsxs)(Qo,{className:E["sider-wrapper"],width:200,children:[(0,r.jsx)(so.Z,{className:E["side-menu"],mode:"inline",defaultSelectedKeys:[g==null?void 0:g.curCategoryId],onClick:ao,selectedKeys:[g==null?void 0:g.curCategoryId],children:(0,y.map)(no,function(o){return(0,r.jsx)(so.Z.Item,{children:(0,r.jsxs)(X.Z,{justify:"space-between",className:E["menu-item-container"],children:[(0,r.jsx)(U.Z,{className:E["menu-item-left-wrapper"],children:(o==null?void 0:o.label)||M.sN}),(0,r.jsx)(U.Z,{children:(o==null?void 0:o.key)!==""&&(0,r.jsx)(Ro.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u4EFB\u52A1\u8BA1\u5212\u5417\uFF1F",onConfirm:function(f){f==null||f.stopPropagation(),Y(o==null?void 0:o.key)},onCancel:function(f){return f==null?void 0:f.stopPropagation()},okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",children:(0,r.jsx)($.ZP,{className:E["delete-button"],type:"text",icon:(0,r.jsx)(Zo.Z,{}),onClick:function(f){f.stopPropagation()}})})})]})},o==null?void 0:o.key)})}),(0,r.jsx)($.ZP,{size:"large",onClick:R,style:{width:"calc(100% - 8px)",margin:"0 4px 4px"},children:(0,r.jsx)(vo.Z,{style:{display:"inline-block",width:"100%"}})})]}),(0,r.jsx)(z.Z,{className:E["layout-right-wrapper"],children:(0,r.jsxs)(To,{className:E["content-wrapper"],children:[(0,r.jsxs)(X.Z,{justify:"space-between",children:[(0,r.jsx)(U.Z,{children:(0,r.jsx)(co.ZP.Group,{className:E["group-type-radio-group"],onChange:ro,value:T,children:(0,y.map)(eo,function(o){return(0,r.jsx)(co.ZP.Button,{value:o==null?void 0:o.todoType,children:"".concat(o==null?void 0:o.status," (").concat(o==null?void 0:o.count,")")},o==null?void 0:o.todoType)})})}),(0,r.jsx)(U.Z,{children:(0,r.jsxs)($.ZP,{type:"primary",size:"large",onClick:function(){return s(g==null?void 0:g.curCategoryId)},children:[(0,r.jsx)(vo.Z,{}),"Add Todo"]},"add-todo")})]}),(0,r.jsx)(Wo,{curActiveCategoryDetail:O,onUpdateCategory:N}),(0,r.jsx)(To,{ref:oo,className:E["todo-list-content-wrapper"],children:(0,r.jsx)(zo,{items:e,distance:1,lockAxis:"y",lockToContainerEdges:!0,lockOffset:"0%",onSortEnd:Z,onRemoveItem:p,onUpdateItem:C})})]})})]})})},Xo=Ho}}]);
