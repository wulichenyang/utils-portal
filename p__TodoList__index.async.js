"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[130],{66425:function(Vo,no,a){a.r(no),a.d(no,{default:function(){return wo}});var so=a(27424),B=a.n(so),vo=a(42122),l=a.n(vo),co=a(861),ao=a.n(co),M=a(55375),Y=function(T){return T.TODO_LIST_ATOM="TODO_LIST_ATOM",T.NOT_DONE_TODO_LIST_ATOM_SELECTOR="NOT_DONE_TODO_LIST_ATOM_SELECTOR",T.DONE_TODO_LIST_ATOM_SELECTOR="DONE_TODO_LIST_ATOM_SELECTOR",T.CUR_TODO_LIST_ATOM_SELECTOR="CUR_TODO_LIST_ATOM_SELECTOR",T.CUR_ACTIVE_CATEGORY_DETAIL_SELECTOR="CUR_ACTIVE_CATEGORY_DETAIL_SELECTOR",T}({}),z=a(59731),h=a(22638),fo=a(69483),k=a.n(fo),L=a(96486),N=a(67294),Z=a(4480),w=(0,Z.cn)({key:Y.TODO_LIST_ATOM,default:{isLoading:!1,todoList:[],categoryInfo:{curCategoryId:"",categoryList:[{id:"",title:M.sN}]}}}),To=(0,Z.nZ)({key:Y.DONE_TODO_LIST_ATOM_SELECTOR,get:function(r){var u=r.get,t=u(w),v=t.todoList,i=t.categoryInfo;return(0,L.filter)(v,function(o){return(o==null?void 0:o.done)&&(i==null?void 0:i.curCategoryId)===((o==null?void 0:o.categoryId)||"")})}}),go=(0,Z.nZ)({key:Y.NOT_DONE_TODO_LIST_ATOM_SELECTOR,get:function(r){var u=r.get,t=u(w),v=t.todoList,i=t.categoryInfo;return(0,L.filter)(v,function(o){return!(o!=null&&o.done)&&(i==null?void 0:i.curCategoryId)===((o==null?void 0:o.categoryId)||"")})}}),yo=(0,Z.nZ)({key:Y.CUR_TODO_LIST_ATOM_SELECTOR,get:function(r){var u=r.get,t=u(w),v=t.todoList,i=t.categoryInfo;return(0,L.filter)(v,function(o){return(i==null?void 0:i.curCategoryId)===((o==null?void 0:o.categoryId)||"")})}}),Co=(0,Z.nZ)({key:Y.CUR_ACTIVE_CATEGORY_DETAIL_SELECTOR,get:function(r){var u=r.get,t=u(w),v=t.categoryInfo;return(0,L.find)(v==null?void 0:v.categoryList,function(i){return(i==null?void 0:i.id)===(v==null?void 0:v.curCategoryId)})}}),ho=function(){var r=(0,Z.FV)(w),u=B()(r,2),t=u[0],v=t.isLoading,i=t.todoList,o=t.categoryInfo,f=u[1],O=(0,Z.sJ)(To),D=(0,Z.sJ)(go),m=(0,Z.sJ)(yo),E=(0,Z.sJ)(Co),g=(0,h.Z)(function(s){k().setItem(z.F.TODO_LIST_KEY,s)}),I=(0,h.Z)(function(s){k().setItem(z.F.TODO_CATEGORY_INFO_KEY,s)}),P=(0,h.Z)(function(s){var c=[].concat(ao()(i),[{id:"".concat(M.Xt).concat(new Date().getTime()),title:"",content:"",seq:"",done:!1,note:"",categoryId:s||""}]);f(function(d){return l()(l()({},d),{},{todoList:c})}),g(c)}),G=(0,h.Z)(function(s){var c=(0,L.filter)(i,function(d){return(d==null?void 0:d.id)!==s});f(function(d){return l()(l()({},d),{},{todoList:c})}),g(c)}),U=(0,h.Z)(function(s){var c=(0,L.filter)(i,function(d){return(d==null?void 0:d.categoryId)!==s});f(function(d){return l()(l()({},d),{},{todoList:c})}),g(c)}),S=(0,h.Z)(function(s){var c=s.id,d=(0,L.map)(i,function(y){return(y==null?void 0:y.id)===c?l()(l()({},y),s):y});f(function(y){return l()(l()({},y),{},{todoList:d})}),g(d)}),K=(0,h.Z)(function(){var s=l()(l()({},o),{},{categoryList:[].concat(ao()((o==null?void 0:o.categoryList)||[]),[{id:"".concat(M.Yy).concat(new Date().getTime()),title:M.Is}])});f(function(c){return l()(l()({},c),{},{categoryInfo:s})}),I(s)}),W=(0,h.Z)(function(s){if(s){var c,d=(0,L.findIndex)(o==null?void 0:o.categoryList,function(C){return(C==null?void 0:C.id)===s}),y=d===-1?"":(o==null||(c=o.categoryList[d-1])===null||c===void 0?void 0:c.id)||"",x=s!==(o==null?void 0:o.curCategoryId)?o==null?void 0:o.curCategoryId:y,eo=(0,L.filter)(o==null?void 0:o.categoryList,function(C){return(C==null?void 0:C.id)!==s}),e=l()(l()({},o),{},{curCategoryId:x,categoryList:eo});f(function(C){return l()(l()({},C),{},{categoryInfo:e})}),I(e),U(s)}}),oo=(0,h.Z)(function(s){var c=s.id,d=(0,L.map)(o==null?void 0:o.categoryList,function(x){return(x==null?void 0:x.id)===c?l()(l()({},x),s):x}),y=l()(l()({},o),{},{categoryList:d});f(function(x){return l()(l()({},x),{},{categoryInfo:y})}),I(y)}),to=(0,h.Z)(function(s){var c=l()(l()({},o),{},{curCategoryId:s});f(function(d){return l()(l()({},d),{},{categoryInfo:c})}),I(c)});return(0,N.useEffect)(function(){f(function(d){return l()(l()({},d),{},{isLoading:!0})});var s=k().getItem(z.F.TODO_CATEGORY_INFO_KEY).then(function(d){d&&f(function(y){return l()(l()({},y),{},{categoryInfo:d})})}),c=k().getItem(z.F.TODO_LIST_KEY).then(function(d){d&&f(function(y){return l()(l()({},y),{},{todoList:d})})});Promise.all([s,c]).finally(function(){f(function(d){return l()(l()({},d),{},{isLoading:!1})})})},[]),{isLoading:v,todoList:i,curTodoList:m,doneTodoList:O,notDoneTodoList:D,categoryInfo:o,curActiveCategoryDetail:E,handleAddTodoItem:P,handleRemoveTodoItem:G,handleUpdateTodoItem:S,handleAddCategory:K,handleRemoveCategory:W,handleUpdateCategory:oo,handleClickCategory:to}},Lo=a(48689),Oo=a(55914),po=a(77554),H=a(97689),Q=a(71230),R=a(15746),mo=a(56616),X=a(68916),$=a(67759),Io=a(88942),F={"todo-item-wrapper":"todo-item-wrapper___tVFjc","check-box":"check-box___YMuVz",title:"title___yALYU",content:"content___MGx0F","delete-icon":"delete-icon___ZYcin"},n=a(85893),Do=H.Z.Title,xo=H.Z.Paragraph,Zo=function(r){var u=r.index,t=r.todoListItem,v=r.onUpdateItem,i=r.onRemoveItem,o=(0,N.useState)(!1),f=B()(o,2),O=f[0],D=f[1],m=(0,N.useRef)(null),E=(0,Io.Z)(),g=B()(E,1),I=g[0],P=function(){setTimeout(function(){return D(!0)})},G=(0,h.Z)(function(){O&&D(!1)}),U=(0,L.debounce)(function(S,K){v(l()({id:t==null?void 0:t.id},S))},200);return(0,Oo.Z)(G,m),(0,po.Z)(["enter","esc"],function(){O&&D(!1)}),O?(0,n.jsx)("div",{className:F["todo-item-wrapper"],ref:m,children:(0,n.jsxs)(X.Z,{form:I,initialValues:{title:(t==null?void 0:t.title)||"",content:(t==null?void 0:t.content)||""},onValuesChange:U,children:[(0,n.jsx)(X.Z.Item,{name:"title",label:"\u6807\u9898",children:(0,n.jsx)($.Z,{})}),(0,n.jsx)(X.Z.Item,{name:"content",label:"\u5185\u5BB9",children:(0,n.jsx)($.Z,{})})]})}):(0,n.jsx)(H.Z,{className:F["todo-item-wrapper"],children:(0,n.jsxs)(Q.Z,{align:"middle",children:[(0,n.jsx)(R.Z,{style:{flex:"none"},children:(0,n.jsx)("div",{className:F["check-box"],children:(0,n.jsx)(mo.Z,{checked:t==null?void 0:t.done,onChange:function(){return v({id:t==null?void 0:t.id,done:!(t!=null&&t.done)})}})})}),(0,n.jsxs)(R.Z,{style:{flex:"1"},children:[(0,n.jsxs)(Do,{className:F.title,level:2,onClick:P,children:[(0,n.jsx)("span",{children:"\u{1F516} "}),"".concat(u,": ").concat((t==null?void 0:t.title)||"")]}),(0,n.jsx)(xo,{className:F.content,onClick:P,children:(t==null?void 0:t.content)||"\u586B\u5199 Todo \u5185\u5BB9..."})]}),(0,n.jsx)(R.Z,{style:{flex:"none"},children:(0,n.jsx)(Lo.Z,{className:F["delete-icon"],onClick:function(){return i(t==null?void 0:t.id)}})})]})})},Ao=Zo,Eo=a(38416),b=a.n(Eo),V,p=function(T){return T.ALL="ALL",T.DONE="DONE",T.NOT_DONE="NOT_DONE",T}({}),_=(V={},b()(V,p.ALL,"\u6240\u6709"),b()(V,p.DONE,"\u5DF2\u5B8C\u6210"),b()(V,p.NOT_DONE,"\u5F85\u529E"),V),So=a(97937),ro=a(24969),jo=a(33904),J=a(21612),io=a(68508),No=a(5737),q=a(15867),lo=a(78045),Ro=a(62666),Mo=function(r){var u=r.curActiveCategoryDetail,t=r.onUpdateCategory,v=(0,N.useState)(!1),i=B()(v,2),o=i[0],f=i[1],O=(0,N.useRef)(),D=(0,h.Z)(function(){f(!0),setTimeout(function(){var g;O==null||(g=O.current)===null||g===void 0||g.focus()})}),m=(0,h.Z)((0,L.throttle)(function(g){var I;t({id:u==null?void 0:u.id,title:g==null||(I=g.target)===null||I===void 0?void 0:I.value})},200)),E=(0,h.Z)(function(){f(!1)});return o?(0,n.jsx)($.Z,{ref:O,value:u==null?void 0:u.title,onBlur:E,onPressEnter:E,onChange:m,style:{marginBottom:"12px"}}):(0,n.jsx)(Ro.Z,{level:3,onClick:D,children:(u==null?void 0:u.title)||M.sN})},Fo=Mo,Po=function(r,u,t){var v=Math.round(t);if(v<0)return Promise.reject("bad duration");var i=r.scrollTop,o=u-i,f=Date.now(),O=function D(){var m=(Date.now()-f)/v;m>1&&(m=1);var E=.5*(1-Math.cos(Math.PI*m)),g=i+o*E;r.scrollTop=g,m<1&&requestAnimationFrame(D)};requestAnimationFrame(O)},Uo=function(r){var u=(0,N.useRef)(null),t=function(){if(u.current!==null){var i,o=u.current.scrollHeight;Po(u.current,o,(i=r==null?void 0:r.duration)!==null&&i!==void 0?i:500)}};return(0,N.useEffect)(t,[u]),{domRef:u,scrollToBottom:t}},A={"layout-all-wrapper":"layout-all-wrapper___YzEYt","sider-wrapper":"sider-wrapper___WE5eN","side-menu":"side-menu___dM783","menu-item-container":"menu-item-container___ryyZw","menu-item-left-wrapper":"menu-item-left-wrapper___IMyuH","delete-button":"delete-button___gbw7P","layout-right-wrapper":"layout-right-wrapper___yPGhM","content-wrapper":"content-wrapper___hpw17","group-type-radio-group":"group-type-radio-group___rrp0Q","todo-list-content-wrapper":"todo-list-content-wrapper___v73us"},uo=J.Z.Content,Bo=J.Z.Sider,Yo=function(){var r=ho(),u=r.isLoading,t=r.curTodoList,v=r.doneTodoList,i=r.notDoneTodoList,o=r.categoryInfo,f=r.curActiveCategoryDetail,O=r.handleAddTodoItem,D=r.handleRemoveTodoItem,m=r.handleUpdateTodoItem,E=r.handleAddCategory,g=r.handleRemoveCategory,I=r.handleUpdateCategory,P=r.handleClickCategory,G=(0,N.useState)(p.NOT_DONE),U=B()(G,2),S=U[0],K=U[1],W=Uo(),oo=W.domRef,to=W.scrollToBottom,s=function(){switch(S){case p.ALL:return t;case p.DONE:return v;case p.NOT_DONE:return i;default:return[]}}(),c=[{todoType:p.ALL,count:(t==null?void 0:t.length)||0,status:_[p.ALL]},{todoType:p.NOT_DONE,count:(i==null?void 0:i.length)||0,status:_[p.NOT_DONE]},{todoType:p.DONE,count:(v==null?void 0:v.length)||0,status:_[p.DONE]}],d=(0,L.map)(o==null?void 0:o.categoryList,function(e){return{key:e==null?void 0:e.id,label:e==null?void 0:e.title}}),y=(0,h.Z)(function(e){var C;K(e==null||(C=e.target)===null||C===void 0?void 0:C.value)}),x=(0,h.Z)(function(e){P(e==null?void 0:e.key)}),eo=(0,h.Z)(function(e){O(e),setTimeout(function(){return to()})});return(0,n.jsx)(jo._z,{header:{title:"Todo list",subTitle:"\u522B\u8BA9\u672A\u6765\u7684\u98CE\u9669\u5F71\u54CD\u73B0\u5728\u7684\u4F60"},loading:u,children:(0,n.jsxs)(J.Z,{className:A["layout-all-wrapper"],children:[(0,n.jsxs)(Bo,{className:A["sider-wrapper"],width:200,children:[(0,n.jsx)(io.Z,{className:A["side-menu"],mode:"inline",defaultSelectedKeys:[o==null?void 0:o.curCategoryId],onClick:x,selectedKeys:[o==null?void 0:o.curCategoryId],children:(0,L.map)(d,function(e){return(0,n.jsx)(io.Z.Item,{children:(0,n.jsxs)(Q.Z,{justify:"space-between",className:A["menu-item-container"],children:[(0,n.jsx)(R.Z,{className:A["menu-item-left-wrapper"],children:(e==null?void 0:e.label)||M.sN}),(0,n.jsx)(R.Z,{children:(e==null?void 0:e.key)!==""&&(0,n.jsx)(No.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u4EFB\u52A1\u8BA1\u5212\u5417\uFF1F",onConfirm:function(j){j==null||j.stopPropagation(),g(e==null?void 0:e.key)},onCancel:function(j){return j==null?void 0:j.stopPropagation()},okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",children:(0,n.jsx)(q.ZP,{className:A["delete-button"],type:"text",icon:(0,n.jsx)(So.Z,{}),onClick:function(j){j.stopPropagation()}})})})]})},e==null?void 0:e.key)})}),(0,n.jsx)(q.ZP,{size:"large",onClick:E,style:{width:"calc(100% - 8px)",margin:"0 4px 4px"},children:(0,n.jsx)(ro.Z,{style:{display:"inline-block",width:"100%"}})})]}),(0,n.jsx)(J.Z,{className:A["layout-right-wrapper"],children:(0,n.jsxs)(uo,{className:A["content-wrapper"],children:[(0,n.jsxs)(Q.Z,{justify:"space-between",children:[(0,n.jsx)(R.Z,{children:(0,n.jsx)(lo.ZP.Group,{className:A["group-type-radio-group"],onChange:y,value:S,children:(0,L.map)(c,function(e){return(0,n.jsx)(lo.ZP.Button,{value:e==null?void 0:e.todoType,children:"".concat(e==null?void 0:e.status," (").concat(e==null?void 0:e.count,")")},e==null?void 0:e.todoType)})})}),(0,n.jsx)(R.Z,{children:(0,n.jsxs)(q.ZP,{type:"primary",size:"large",onClick:function(){return eo(o==null?void 0:o.curCategoryId)},children:[(0,n.jsx)(ro.Z,{}),"Add Todo"]},"add-todo")})]}),(0,n.jsx)(Fo,{curActiveCategoryDetail:f,onUpdateCategory:I}),(0,n.jsx)(uo,{ref:oo,className:A["todo-list-content-wrapper"],children:(0,L.map)(s,function(e,C){return(0,n.jsx)(Ao,{index:C+1,todoListItem:e,onUpdateItem:m,onRemoveItem:D},e==null?void 0:e.id)})})]})})]})})},wo=Yo}}]);
